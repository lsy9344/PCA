2025-06-30 15:58:53,018 - INFO - [B] 쿠폰 자동화 시작 - 차량번호: 0280, 매장: B
2025-06-30 15:59:04,381 - INFO - [성공] B 매장 로그인 성공
2025-06-30 15:59:06,446 - INFO - [성공] 안내 팝업 처리 완료
2025-06-30 15:59:06,464 - INFO - [검색] 검색 상태 유지 체크박스 발견 - 현재 상태: 체크됨
2025-06-30 15:59:06,464 - INFO - [정보] 검색 상태 유지 체크박스 이미 활성화됨
2025-06-30 15:59:06,465 - INFO - [테스트] 입차일 설정 시작
2025-06-30 15:59:06,477 - INFO - [성공] 입차일 입력 필드 발견: text=입차일
2025-06-30 15:59:14,140 - INFO - [성공] 입차일 '2025-06-10' 설정 완료
2025-06-30 15:59:18,301 - INFO - [성공] 차량번호 '0280' 검색 성공
2025-06-30 15:59:18,301 - INFO - [성공] B 매장 무료 쿠폰은 항상 보유: 999개
2025-06-30 15:59:18,319 - INFO - [성공] 현재 페이지에서 남은잔여량 발견: 
												남은잔여량
												
													20,400 원
												
											
2025-06-30 15:59:18,320 - INFO - [성공] 남은잔여량: 20400원 → 유료 30분할인 (판매 : 300 ) 68개
2025-06-30 15:59:18,320 - INFO - [성공] 현재 페이지에서 남은잔여량 확인: 
												남은잔여량
												
													20,400 원
												
											
2025-06-30 15:59:18,321 - INFO - [분석] 할인 내역 테이블 분석 시작
2025-06-30 15:59:18,326 - INFO - [분석] 할인 데이터 행 수: 4
2025-06-30 15:59:18,361 - INFO - [분석] 데이터 행 2: ['1', '유료 30분할인', '215(이수열)', '2025-06-30 15:28:58.77', '']
2025-06-30 15:59:18,362 - INFO - [분석] 할인 데이터: 순번=[1] 할인값=[유료 30분할인] 등록자=[215(이수열)] 시간=[2025-06-30 15:28:58.77]
2025-06-30 15:59:18,363 - INFO -    [매장] 우리 매장 할인: PAID_30MIN - 215(이수열) (2025-06-30 15:28:58.77)
2025-06-30 15:59:18,393 - INFO - [분석] 데이터 행 3: ['2', '유료 30분할인', '215(이수열)', '2025-06-30 15:28:50.6', '']
2025-06-30 15:59:18,394 - INFO - [분석] 할인 데이터: 순번=[2] 할인값=[유료 30분할인] 등록자=[215(이수열)] 시간=[2025-06-30 15:28:50.6]
2025-06-30 15:59:18,395 - INFO -    [매장] 우리 매장 할인: PAID_30MIN - 215(이수열) (2025-06-30 15:28:50.6)
2025-06-30 15:59:18,423 - INFO - [분석] 데이터 행 4: ['3', '무료 1시간할인', '215(이수열)', '2025-06-30 15:28:42.463', '']
2025-06-30 15:59:18,424 - INFO - [분석] 할인 데이터: 순번=[3] 할인값=[무료 1시간할인] 등록자=[215(이수열)] 시간=[2025-06-30 15:28:42.463]
2025-06-30 15:59:18,425 - INFO -    [매장] 우리 매장 할인: FREE_1HOUR - 215(이수열) (2025-06-30 15:28:42.463)
2025-06-30 15:59:18,425 - INFO - [분석] 할인 내역 분석 완료: 전체 3건, 우리 매장 3건
2025-06-30 15:59:18,426 - INFO - [분석] B 매장 쿠폰 현황 분석:
2025-06-30 15:59:18,426 - INFO -    [보유] 현재 보유 쿠폰: {'무료 1시간할인': {'car': 999, 'total': 999}, '유료 30분할인 (판매 : 300 )': {'car': 68, 'total': 68}}
2025-06-30 15:59:18,427 - INFO -    [매장] 우리 매장에서 적용한 쿠폰: {'PAID_30MIN': 2, 'FREE_1HOUR': 1}
2025-06-30 15:59:18,427 - INFO -    [전체] 총 적용 쿠폰 (전체): {'PAID_30MIN': 2, 'FREE_1HOUR': 1}
2025-06-30 15:59:18,430 - INFO - [B] discount_info: {'무료 1시간할인': {'car': 999, 'total': 999}, '유료 30분할인 (판매 : 300 )': {'car': 68, 'total': 68}}
2025-06-30 15:59:18,431 - INFO - [B] my_history: {'PAID_30MIN': 2, 'FREE_1HOUR': 1}
2025-06-30 15:59:18,431 - INFO - [B] total_history: {'PAID_30MIN': 2, 'FREE_1HOUR': 1}
2025-06-30 15:59:18,432 - INFO - [B] is_weekday: True
2025-06-30 15:59:18,443 - INFO - [B] calculate_required_coupons 성공! 결과: 2개
2025-06-30 15:59:18,444 - INFO - [B] 계산 결과: 무료 1시간할인 1개
2025-06-30 15:59:18,445 - INFO - [B] 계산 결과: 유료 30분할인 (판매 : 300 ) 4개
2025-06-30 15:59:18,445 - INFO - [B] >>>>>[적용할 쿠폰]
2025-06-30 15:59:18,446 - INFO - [B] 무료 1시간할인: 1개
2025-06-30 15:59:18,446 - INFO - [B] 유료 30분할인 (판매 : 300 ): 4개
2025-06-30 15:59:18,447 - INFO - [쿠폰] B 매장 쿠폰 적용 시작: {'무료 1시간할인': 1, '유료 30분할인 (판매 : 300 )': 4}
2025-06-30 15:59:18,448 - INFO - [디버그] 전달받은 쿠폰 키들: ['무료 1시간할인', '유료 30분할인 (판매 : 300 )']
2025-06-30 15:59:18,448 - INFO - [디버그] 쿠폰 '무료 1시간할인' 적용 시작: 1개
2025-06-30 15:59:18,449 - INFO - [쿠폰] FREE_1HOUR 쿠폰 적용 시작 (순서: 1)
2025-06-30 15:59:18,454 - INFO - [분석] 적용 전 할인내역 행 수: 1
2025-06-30 15:59:19,494 - ERROR - [실패] FREE_1HOUR 쿠폰 적용 중 오류: Error: strict mode violation: locator("text=무료 1시간할인") resolved to 2 elements:
    1) <td align="right" valign="middle">무료 1시간할인</td> aka get_by_role("cell", name="무료 1시간할인", exact=True)
    2) <a id="1" price="0" time="60" value="무료 1시간할인" name…>무료 1시간할인</a> aka get_by_role("link", name="무료 1시간할인")

2025-06-30 15:59:19,496 - ERROR - [실패] 무료 1시간할인 1개 적용 실패
2025-06-30 15:59:19,496 - ERROR - [B] 자동화 실패: 쿠폰 적용 실패 | {"store_id": "B", "vehicle": "0280", "step": "쿠폰적용", "stack_trace": "Traceback (most recent call last):\n  File \"C:\\Code\\Project\\parking_cupon_auto\\PCA_250628\\core\\application\\use_cases\\apply_coupon_use_case.py\", line 118, in execute\n    raise Exception(\"쿠폰 적용 실패\")\nException: 쿠폰 적용 실패\n"}
2025-06-30 15:59:20,570 - INFO - 텔레그램 알림 전송 성공
2025-06-30 15:59:20,636 - INFO - 페이지 정리 완료
2025-06-30 15:59:20,831 - INFO - 브라우저 정리 완료
2025-06-30 15:59:20,844 - INFO - Playwright 정리 완료
