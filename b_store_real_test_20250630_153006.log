2025-06-30 15:30:06,566 - INFO - [B] 쿠폰 자동화 시작 - 차량번호: 0280, 매장: B
2025-06-30 15:30:20,012 - INFO - [성공] B 매장 로그인 성공
2025-06-30 15:30:22,069 - INFO - [성공] 안내 팝업 처리 완료
2025-06-30 15:30:22,103 - INFO - [검색] 검색 상태 유지 체크박스 발견 - 현재 상태: 체크됨
2025-06-30 15:30:22,104 - INFO - [정보] 검색 상태 유지 체크박스 이미 활성화됨
2025-06-30 15:30:22,105 - INFO - [테스트] 입차일 설정 시작
2025-06-30 15:30:22,126 - INFO - [성공] 입차일 입력 필드 발견: text=입차일
2025-06-30 15:30:29,927 - INFO - [성공] 입차일 '2025-06-10' 설정 완료
2025-06-30 15:30:34,195 - INFO - [성공] 차량번호 '0280' 검색 성공
2025-06-30 15:30:34,196 - INFO - [성공] B 매장 무료 쿠폰은 항상 보유: 999개
2025-06-30 15:30:34,218 - INFO - [성공] 현재 페이지에서 남은잔여량 발견: 
												남은잔여량
												
													20,400 원
												
											
2025-06-30 15:30:34,219 - INFO - [성공] 남은잔여량: 20400원 → 유료 30분할인 (판매 : 300 ) 68개
2025-06-30 15:30:34,220 - INFO - [성공] 현재 페이지에서 남은잔여량 확인: 
												남은잔여량
												
													20,400 원
												
											
2025-06-30 15:30:34,221 - INFO - [분석] 할인 내역 테이블 분석 시작
2025-06-30 15:30:34,230 - INFO - [분석] 페이지 전체 테이블 수: 7
2025-06-30 15:30:34,249 - INFO - [성공] 할인내역 테이블 발견: 테이블 3
2025-06-30 15:30:34,255 - INFO - [분석] tbody에서 발견된 행 수: 2
2025-06-30 15:30:34,287 - INFO - [분석] 헤더 행 스킵: ['순번', '할인값', '등록자', '등록시간', '삭제']
2025-06-30 15:30:34,288 - INFO - [분석] 할인 내역 분석 완료: 총 0건의 할인 발견
2025-06-30 15:30:34,289 - INFO - [분석] B 매장 쿠폰 현황 분석:
2025-06-30 15:30:34,289 - INFO -    [보유] 현재 보유 쿠폰: {'무료 1시간할인': {'car': 999, 'total': 999}, '유료 30분할인 (판매 : 300 )': {'car': 68, 'total': 68}}
2025-06-30 15:30:34,290 - INFO -    [매장] 우리 매장에서 적용한 쿠폰: {}
2025-06-30 15:30:34,291 - INFO -    [전체] 총 적용 쿠폰 (전체): {}
2025-06-30 15:30:34,294 - INFO - [B] discount_info: {'무료 1시간할인': {'car': 999, 'total': 999}, '유료 30분할인 (판매 : 300 )': {'car': 68, 'total': 68}}
2025-06-30 15:30:34,294 - INFO - [B] my_history: {}
2025-06-30 15:30:34,295 - INFO - [B] total_history: {}
2025-06-30 15:30:34,295 - INFO - [B] is_weekday: True
2025-06-30 15:30:34,306 - INFO - [B] calculate_required_coupons 성공! 결과: 2개
2025-06-30 15:30:34,307 - INFO - [B] 계산 결과: 무료 1시간할인 1개
2025-06-30 15:30:34,307 - INFO - [B] 계산 결과: 유료 30분할인 (판매 : 300 ) 4개
2025-06-30 15:30:34,308 - INFO - [B] >>>>>[적용할 쿠폰]
2025-06-30 15:30:34,308 - INFO - [B] 무료 1시간할인: 1개
2025-06-30 15:30:34,309 - INFO - [B] 유료 30분할인 (판매 : 300 ): 4개
2025-06-30 15:30:34,309 - INFO - [쿠폰] B 매장 쿠폰 적용 시작: {'무료 1시간할인': 1, '유료 30분할인 (판매 : 300 )': 4}
2025-06-30 15:30:34,310 - INFO - [디버그] 전달받은 쿠폰 키들: ['무료 1시간할인', '유료 30분할인 (판매 : 300 )']
2025-06-30 15:30:34,310 - INFO - [디버그] 쿠폰 '무료 1시간할인' 적용 시작: 1개
2025-06-30 15:30:34,311 - INFO - [쿠폰] FREE_1HOUR 쿠폰 적용 시작 (순서: 1)
2025-06-30 15:30:34,316 - INFO - [분석] 적용 전 할인내역 행 수: 1
2025-06-30 15:30:35,368 - ERROR - [실패] FREE_1HOUR 쿠폰 적용 중 오류: Error: strict mode violation: locator("text=무료 1시간할인") resolved to 2 elements:
    1) <td align="right" valign="middle">무료 1시간할인</td> aka get_by_role("cell", name="무료 1시간할인", exact=True)
    2) <a id="1" price="0" time="60" value="무료 1시간할인" name…>무료 1시간할인</a> aka get_by_role("link", name="무료 1시간할인")

2025-06-30 15:30:35,370 - ERROR - [실패] 무료 1시간할인 1개 적용 실패
2025-06-30 15:30:35,372 - ERROR - [B] 자동화 실패: 쿠폰 적용 실패 | {"store_id": "B", "vehicle": "0280", "step": "쿠폰적용", "stack_trace": "Traceback (most recent call last):\n  File \"c:\\Code\\Project\\parking_cupon_auto\\PCA_250628\\core\\application\\use_cases\\apply_coupon_use_case.py\", line 118, in execute\n    raise Exception(\"쿠폰 적용 실패\")\nException: 쿠폰 적용 실패\n"}
2025-06-30 15:30:36,364 - INFO - 텔레그램 알림 전송 성공
2025-06-30 15:30:36,458 - INFO - 페이지 정리 완료
2025-06-30 15:30:36,639 - INFO - 브라우저 정리 완료
2025-06-30 15:30:36,652 - INFO - Playwright 정리 완료
